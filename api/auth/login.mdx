---
title: "Login"
api: "POST /v1/auth/login"
description: "Authenticate user with email and password, optionally with 2FA"
---

## Overview

Authenticate a user with their email and password to get access and refresh tokens. If 2FA is enabled for the user, you'll receive a 402 status code and need to verify the 2FA code.

<Note>
Access tokens expire after 2 hours. Use the refresh token to get new access tokens without requiring user re-authentication.
</Note>

## Request

<ParamField body="email" type="string" required>
  User email address
</ParamField>

<ParamField body="password" type="string" required>
  User password
</ParamField>

## Response

<ResponseField name="access_token" type="string">
  JWT access token for API authentication
</ResponseField>

<ResponseField name="refresh_token" type="string">
  JWT refresh token for getting new access tokens
</ResponseField>

<ResponseField name="expires_in" type="number">
  Access token expiration time in seconds (7200 = 2 hours)
</ResponseField>

<ResponseField name="is_2fa_enabled" type="boolean">
  Whether 2FA is enabled for this user
</ResponseField>

## Example Request

<CodeGroup>

```bash cURL
curl -X POST https://api.railsfromthecrypt.com/v1/auth/login \
  -H "Content-Type: application/json" \
  -d '{
    "email": "user@example.com",
    "password": "StrongP@ssw0rd!"
  }'
```

```javascript JavaScript
const response = await fetch('https://api.railsfromthecrypt.com/v1/auth/login', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
  },
  body: JSON.stringify({
    email: 'user@example.com',
    password: 'StrongP@ssw0rd!'
  })
});

const data = await response.json();
console.log(data);
```

```python Python
import requests

response = requests.post(
    'https://api.railsfromthecrypt.com/v1/auth/login',
    json={
        'email': 'user@example.com',
        'password': 'StrongP@ssw0rd!'
    }
)

data = response.json()
print(data)
```

```php PHP
<?php

$response = $httpClient->post('https://api.railsfromthecrypt.com/v1/auth/login', [
    'json' => [
        'email' => 'user@example.com',
        'password' => 'StrongP@ssw0rd!'
    ]
]);

$data = $response->json();
```

</CodeGroup>

## Example Response

<ResponseExample>

```json Success Response
{
  "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjEyM2U0NTY3LWU4OWItMTJkMy1hNDU2LTQyNjYxNDE3NDAwMCIsInRva2VuX3R5cGUiOiJsb2dpbiIsImxldmVsIjoxLCJpYXQiOjE2MzA5OTUyMDAsImV4cCI6MTYzMTAwMjQwMH0.example",
  "refresh_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjEyM2U0NTY3LWU4OWItMTJkMy1hNDU2LTQyNjYxNDE3NDAwMCIsInRva2VuX3R5cGUiOiJyZWZyZXNoIiwibGV2ZWwiOjEsImlhdCI6MTYzMDk5NTIwMCwiZXhwIjoxNjMxMDYwODAwfQ.example",
  "expires_in": 7200,
  "is_2fa_enabled": false
}
```

```json 2FA Required Response
{
  "message": "Two-factor authentication required",
  "status": 402
}
```

</ResponseExample>

## Error Responses

<ResponseField name="message" type="string">
  Error description
</ResponseField>

<ResponseField name="error" type="object">
  Error details
</ResponseField>

<ResponseField name="error.code" type="string">
  Error code (e.g., INVALID_CREDENTIALS, 2FA_REQUIRED)
</ResponseField>

<ResponseField name="error.type" type="string">
  Error type (e.g., authentication_error)
</ResponseField>

### Common Error Codes

<CardGroup cols={2}>
  <Card title="401 Unauthorized" icon="exclamation-triangle">
    - **INVALID_CREDENTIALS**: Invalid email or password
    - **ACCOUNT_LOCKED**: Account is locked due to too many failed attempts
    - **ACCOUNT_DISABLED**: Account has been disabled
  </Card>
  <Card title="402 Payment Required" icon="shield-check">
    - **2FA_REQUIRED**: Two-factor authentication is required
    - Use the `/v1/auth/verify` endpoint to provide 2FA code
  </Card>
  <Card title="429 Too Many Requests" icon="clock">
    - **RATE_LIMIT_EXCEEDED**: Too many login attempts
    - Wait before retrying
  </Card>
  <Card title="500 Internal Server Error" icon="server">
    - **INTERNAL_ERROR**: Unexpected server error
    - Retry the request
  </Card>
</CardGroup>

## Usage Examples

### Basic Login

<CodeGroup>

```javascript JavaScript
async function login(email, password) {
  try {
    const response = await fetch('https://api.railsfromthecrypt.com/v1/auth/login', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({ email, password })
    });

    const data = await response.json();

    if (response.status === 402) {
      // 2FA required
      const code = prompt('Enter 2FA code:');
      return await verify2FA(data.access_token, code);
    }

    if (!response.ok) {
      throw new Error(data.message);
    }

    // Store tokens securely
    localStorage.setItem('access_token', data.access_token);
    localStorage.setItem('refresh_token', data.refresh_token);
    
    return data;
  } catch (error) {
    console.error('Login failed:', error);
    throw error;
  }
}
```

```python Python
def login(email, password):
    try:
        response = requests.post(
            'https://api.railsfromthecrypt.com/v1/auth/login',
            json={'email': email, 'password': password}
        )
        
        data = response.json()
        
        if response.status_code == 402:
            # 2FA required
            code = input('Enter 2FA code: ')
            return verify_2fa(data['access_token'], code)
        
        if not response.ok:
            raise Exception(data['message'])
        
        # Store tokens securely
        return data
        
    except Exception as e:
        print(f'Login failed: {e}')
        raise
```

</CodeGroup>

### Login with 2FA

<CodeGroup>

```javascript JavaScript
async function loginWith2FA(email, password, code) {
  try {
    // First, attempt login
    const loginResponse = await fetch('https://api.railsfromthecrypt.com/v1/auth/login', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({ email, password })
    });

    if (loginResponse.status === 402) {
      // 2FA required, verify code
      const verifyResponse = await fetch('https://api.railsfromthecrypt.com/v1/auth/verify', {
        method: 'POST',
        headers: {
          'Authorization': `Bearer ${data.access_token}`,
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({ code })
      });

      if (!verifyResponse.ok) {
        throw new Error('Invalid 2FA code');
      }

      return await verifyResponse.json();
    }

    return await loginResponse.json();
  } catch (error) {
    console.error('Login with 2FA failed:', error);
    throw error;
  }
}
```

</CodeGroup>

### Token Management

<CodeGroup>

```javascript JavaScript
class TokenManager {
  constructor() {
    this.accessToken = localStorage.getItem('access_token');
    this.refreshToken = localStorage.getItem('refresh_token');
  }

  async refreshAccessToken() {
    if (!this.refreshToken) {
      throw new Error('No refresh token available');
    }

    try {
      const response = await fetch('https://api.railsfromthecrypt.com/v1/auth/refresh', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({
          refresh_token: this.refreshToken
        })
      });

      if (!response.ok) {
        throw new Error('Token refresh failed');
      }

      const data = await response.json();
      this.accessToken = data.access_token;
      this.refreshToken = data.refresh_token;
      
      // Update stored tokens
      localStorage.setItem('access_token', data.access_token);
      localStorage.setItem('refresh_token', data.refresh_token);
      
      return data;
    } catch (error) {
      // Refresh failed, redirect to login
      this.logout();
      throw error;
    }
  }

  logout() {
    this.accessToken = null;
    this.refreshToken = null;
    localStorage.removeItem('access_token');
    localStorage.removeItem('refresh_token');
  }
}
```

</CodeGroup>

## Security Considerations

<Warning>
Never store passwords in plain text or send them over unsecured connections. Always use HTTPS for authentication requests.
</Warning>

<AccordionGroup>
  <Accordion title="Token Storage">
    - Store tokens securely (not in localStorage for sensitive applications)
    - Use secure HTTP-only cookies when possible
    - Implement token rotation for long-running applications
    - Clear tokens on logout
  </Accordion>
  <Accordion title="Password Security">
    - Use strong, unique passwords
    - Implement password complexity requirements
    - Consider implementing password hashing on client side
    - Never log or expose passwords
  </Accordion>
  <Accordion title="Rate Limiting">
    - Implement client-side rate limiting
    - Handle 429 responses gracefully
    - Use exponential backoff for retries
    - Monitor login attempt patterns
  </Accordion>
  <Accordion title="2FA Security">
    - Always prompt for 2FA when required
    - Store 2FA codes securely
    - Implement proper 2FA code validation
    - Consider backup codes for recovery
  </Accordion>
</AccordionGroup>

## Related Endpoints

<CardGroup cols={2}>
  <Card
    title="Refresh Token"
    icon="refresh"
    href="/api/auth/refresh"
  >
    Get new access tokens using refresh token
  </Card>
  <Card
    title="Verify 2FA"
    icon="shield-check"
    href="/api/auth/verify-2fa"
  >
    Verify two-factor authentication code
  </Card>
  <Card
    title="Logout"
    icon="sign-out"
    href="/api/auth/logout"
  >
    Invalidate tokens and logout user
  </Card>
  <Card
    title="Forgot Password"
    icon="key"
    href="/api/auth/forgot-password"
  >
    Request password reset
  </Card>
</CardGroup>
