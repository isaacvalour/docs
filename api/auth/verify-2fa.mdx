---
title: "Verify 2FA"
api: "POST /v1/auth/verify-2fa"
description: "Verify two-factor authentication code"
---

## Overview

Verify a two-factor authentication (2FA) code during login. This endpoint is called after successful email/password authentication when 2FA is enabled.

<Note>
  2FA codes are typically valid for 30 seconds and can only be used once.
</Note>

## Request

<ParamField body="email" type="string" required>
  User's email address.
</ParamField>

<ParamField body="password" type="string" required>
  User's password.
</ParamField>

<ParamField body="code" type="string" required>
  Six-digit 2FA code from authenticator app.
</ParamField>

## Response

<ResponseField name="success" type="boolean">
  Indicates if the 2FA verification was successful.
</ResponseField>

<ResponseField name="message" type="string">
  Success message.
</ResponseField>

<ResponseField name="data" type="object">
  Authentication data object.
</ResponseField>

<ResponseField name="data.access_token" type="string">
  JWT access token.
</ResponseField>

<ResponseField name="data.refresh_token" type="string">
  JWT refresh token.
</ResponseField>

<ResponseField name="data.expires_in" type="number">
  Access token expiration time in seconds.
</ResponseField>

<ResponseField name="data.token_type" type="string">
  Token type, typically "Bearer".
</ResponseField>

<ResponseField name="data.user" type="object">
  User information object.
</ResponseField>

<ResponseField name="data.user.id" type="string">
  User identifier.
</ResponseField>

<ResponseField name="data.user.email" type="string">
  User's email address.
</ResponseField>

<ResponseField name="data.user.first_name" type="string">
  User's first name.
</ResponseField>

<ResponseField name="data.user.last_name" type="string">
  User's last name.
</ResponseField>

<ResponseField name="data.user.2fa_enabled" type="boolean">
  Whether 2FA is enabled for the user.
</ResponseField>

## Example Request

<CodeGroup>

```bash cURL
curl -X POST "https://api.railsfromthecrypt.com/v1/auth/verify-2fa" \
  -H "Content-Type: application/json" \
  -d '{
    "email": "john.doe@example.com",
    "password": "SecurePass123",
    "code": "123456"
  }'
```

```javascript JavaScript
const response = await fetch('https://api.railsfromthecrypt.com/v1/auth/verify-2fa', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    email: 'john.doe@example.com',
    password: 'SecurePass123',
    code: '123456'
  })
});

const data = await response.json();
console.log(data);
```

```python Python
import requests

response = requests.post(
    'https://api.railsfromthecrypt.com/v1/auth/verify-2fa',
    json={
        'email': 'john.doe@example.com',
        'password': 'SecurePass123',
        'code': '123456'
    }
)

data = response.json()
print(data)
```

</CodeGroup>

## Example Response

<ResponseExample>

```json Success Response
{
  "success": true,
  "message": "2FA verification successful",
  "data": {
    "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "refresh_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "expires_in": 3600,
    "token_type": "Bearer",
    "user": {
      "id": "user_1234567890",
      "email": "john.doe@example.com",
      "first_name": "John",
      "last_name": "Doe",
      "2fa_enabled": true
    }
  }
}
```

</ResponseExample>

## Error Responses

<ResponseExample>

```json Invalid Credentials
{
  "success": false,
  "message": "Invalid email or password",
  "error": {
    "code": "INVALID_CREDENTIALS",
    "type": "authentication_error",
    "details": "The email or password is incorrect"
  }
}
```

```json Invalid 2FA Code
{
  "success": false,
  "message": "Invalid 2FA code",
  "error": {
    "code": "INVALID_2FA_CODE",
    "type": "authentication_error",
    "details": "The 2FA code is invalid or expired"
  }
}
```

```json 2FA Not Enabled
{
  "success": false,
  "message": "2FA not enabled",
  "error": {
    "code": "2FA_NOT_ENABLED",
    "type": "authentication_error",
    "details": "Two-factor authentication is not enabled for this account"
  }
}
```

</ResponseExample>

## Status Codes

<ResponseField name="200" type="number">
  2FA verification successful
</ResponseField>

<ResponseField name="400" type="number">
  Bad request - validation errors
</ResponseField>

<ResponseField name="401" type="number">
  Unauthorized - invalid credentials or 2FA code
</ResponseField>

<ResponseField name="500" type="number">
  Internal server error
</ResponseField>

## Notes

- 2FA codes are time-based and change every 30 seconds
- Codes can only be used once
- The code must be entered within the 30-second window
- 2FA must be enabled for the user account
- Use a compatible authenticator app (Google Authenticator, Authy, etc.)

## Security Considerations

- 2FA codes are cryptographically secure
- Failed attempts are rate-limited to prevent brute force attacks
- Codes expire after 30 seconds for security
- Consider implementing backup codes for account recovery
- Store access tokens securely after successful authentication

## Implementation Example

<CodeGroup>

```javascript JavaScript
class TwoFactorAuth {
  constructor(apiClient) {
    this.apiClient = apiClient;
  }
  
  async verify2FA(email, password, code) {
    try {
      const response = await this.apiClient.post('/v1/auth/verify-2fa', {
        email: email,
        password: password,
        code: code
      });
      
      if (response.success) {
        // Store tokens
        localStorage.setItem('access_token', response.data.access_token);
        localStorage.setItem('refresh_token', response.data.refresh_token);
        
        // Redirect to dashboard
        window.location.href = '/dashboard';
        
        return response.data;
      } else {
        // Show error message
        this.showErrorMessage(response.message);
        return null;
      }
    } catch (error) {
      this.showErrorMessage('An error occurred during 2FA verification');
      return null;
    }
  }
  
  validate2FACode(code) {
    // Check if code is 6 digits
    return /^\d{6}$/.test(code);
  }
}

// Usage
const twoFactorAuth = new TwoFactorAuth(apiClient);

document.getElementById('2fa-form').addEventListener('submit', async (e) => {
  e.preventDefault();
  
  const email = document.getElementById('email').value;
  const password = document.getElementById('password').value;
  const code = document.getElementById('2fa-code').value;
  
  if (twoFactorAuth.validate2FACode(code)) {
    await twoFactorAuth.verify2FA(email, password, code);
  } else {
    alert('Please enter a valid 6-digit 2FA code');
  }
});
```

</CodeGroup>

## Related Endpoints

<CardGroup cols={2}>
  <Card
    title="Login"
    icon="sign-in-alt"
    href="/api/auth/login"
  >
    Login with email and password
  </Card>
  <Card
    title="Enable 2FA"
    icon="shield-alt"
    href="/api/2fa/enable"
  >
    Enable two-factor authentication
  </Card>
  <Card
    title="2FA QR Code"
    icon="qrcode"
    href="/api/2fa/qrcode"
  >
    Get 2FA setup QR code
  </Card>
  <Card
    title="Authentication Guide"
    icon="book"
    href="/authentication"
  >
    Complete authentication guide
  </Card>
</CardGroup>
